
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>R√©gression non-param√©trique &#8212; Kickstarter Project Analysis  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=3181d424bc0d3cce17c7b026e09d78c270cea3e2" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=19b21d1c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/regression-models';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="R√©gression supervis√©e" href="supervised-regression.html" />
    <link rel="prev" title="Estimation param√©trique univari√©e" href="parametric-estimation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Kickstarter Project Analysis  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">üìí Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="analyse-exploratoire.html">Analyse exploratoire</a></li>
<li class="toctree-l1"><a class="reference internal" href="non-parametric-estimation.html">Estimation non-param√©trique univari√©e</a></li>
<li class="toctree-l1"><a class="reference internal" href="parametric-estimation.html">Estimation param√©trique univari√©e</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">R√©gression non-param√©trique</a></li>
<li class="toctree-l1"><a class="reference internal" href="supervised-regression.html">R√©gression supervis√©e</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üìù How-to guides</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../how-to/poetry.html">Poetry tutorial</a></li>






<li class="toctree-l1"><a class="reference internal" href="../how-to/python-env-vscode.html">Python env with VS Code</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üìñ Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../docstring/modules.html">Kickstarter Project Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../docstring/constants.html">constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../docstring/utils.html">utils module</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/regression-models.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>R√©gression non-param√©trique</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#donnees">Donn√©es</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-du-hazard-proportionnel">V√©rification du hazard proportionnel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeles-non-parametrique">Mod√®les non-param√©trique</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modele-de-cox">Mod√®le de Cox</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-cox-aalen-additif">Cross-validation (Cox &amp; Aalen additif)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predictions">Pr√©dictions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="regression-non-parametrique">
<h1>R√©gression non-param√©trique<a class="headerlink" href="#regression-non-parametrique" title="Link to this heading">#</a></h1>
<p><strong>Objectif</strong></p>
<ul class="simple">
<li><p>v√©rifier l‚Äôhypoth√®se de hazard proportionnel</p></li>
<li><p>r√©gression non-param√©trique et param√©trique</p></li>
<li><p>choisir le meilleur mod√®le pour chaque</p></li>
</ul>
<p><strong>Tableau.</strong> Notre d√©marche pour les r√©gressions non-param√©triques.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>R√©gressions non-param√©triques test√©es</p></th>
<th class="head text-left"><p><strong>Crit√®re de s√©lection</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>- Cox proportionnel</p></td>
<td class="text-left"><p>- indice de concordance</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>- Aalen additif</p></td>
<td class="text-left"><p>- MAE de pr√©diction (cross-valid√©e)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>- Aalen additif avec p√©nalit√© (hyper-param√®tre)</p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
<p><strong>Tableau.</strong> Notre d√©marche pour les r√©gressions param√©triques.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>R√©gressions param√©triques test√©es</p></th>
<th class="head text-left"><p><strong>Crit√®re de s√©lection</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>- Weibull AFT</p></td>
<td class="text-left"><p>- AIC</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>- Exponentiel par morceaux (3 morceaux)</p></td>
<td class="text-left"><p>- BIC</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>- Exponentiel par morceaux (5 morceaux)</p></td>
<td class="text-left"><p>- MAE de pr√©diction (cross-valid√©e)</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">lifelines</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">lifelines</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos"> 5</span>    <span class="n">AalenAdditiveFitter</span><span class="p">,</span>
<span class="linenos"> 6</span>    <span class="n">CoxPHFitter</span><span class="p">,</span>
<span class="linenos"> 7</span>    <span class="n">LogNormalAFTFitter</span><span class="p">,</span>
<span class="linenos"> 8</span>    <span class="n">PiecewiseExponentialRegressionFitter</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="n">WeibullAFTFitter</span><span class="p">,</span>
<span class="linenos">10</span>    <span class="n">WeibullFitter</span><span class="p">,</span>
<span class="linenos">11</span><span class="p">)</span>
<span class="linenos">12</span><span class="kn">from</span> <span class="nn">lifelines.plotting</span> <span class="kn">import</span> <span class="n">qq_plot</span>
<span class="linenos">13</span><span class="kn">from</span> <span class="nn">lifelines.utils</span> <span class="kn">import</span> <span class="n">find_best_parametric_model</span><span class="p">,</span> <span class="n">k_fold_cross_validation</span>
<span class="linenos">14</span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="linenos">15</span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">init_notebook</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">init_notebook</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="donnees">
<h2>Donn√©es<a class="headerlink" href="#donnees" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="linenos">2</span>    <span class="s2">&quot;data/kickstarter_1.csv&quot;</span><span class="p">,</span>
<span class="linenos">3</span>    <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<span class="linenos"> 2</span>    <span class="p">[</span>
<span class="linenos"> 3</span>        <span class="s2">&quot;day_succ&quot;</span><span class="p">,</span>
<span class="linenos"> 4</span>        <span class="s2">&quot;Status&quot;</span><span class="p">,</span>
<span class="linenos"> 5</span>        <span class="s2">&quot;has_video&quot;</span><span class="p">,</span>
<span class="linenos"> 6</span>        <span class="s2">&quot;facebook_connected&quot;</span><span class="p">,</span>
<span class="linenos"> 7</span>        <span class="s2">&quot;goal&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span>        <span class="s2">&quot;facebook_friends&quot;</span><span class="p">,</span>
<span class="linenos"> 9</span>    <span class="p">]</span>
<span class="linenos">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">event_times</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;day_succ&quot;</span><span class="p">]</span>
<span class="linenos">2</span><span class="n">event_observed</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">cph</span> <span class="o">=</span> <span class="n">CoxPHFitter</span><span class="p">()</span>
<span class="linenos">2</span><span class="n">cph</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">duration_col</span><span class="o">=</span><span class="s2">&quot;day_succ&quot;</span><span class="p">,</span> <span class="n">event_col</span><span class="o">=</span><span class="s2">&quot;Status&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lifelines.CoxPHFitter: fitted with 4175 total observations, 2213 right-censored observations&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="verification-du-hazard-proportionnel">
<h2>V√©rification du hazard proportionnel<a class="headerlink" href="#verification-du-hazard-proportionnel" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">cph</span><span class="o">.</span><span class="n">check_assumptions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">show_plots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Bootstrapping lowess lines. May take a moment...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The ``p_value_threshold`` is set at 0.01. Even under the null hypothesis of no violations, some
covariates will be below the threshold by chance. This is compounded when there are many covariates.
Similarly, when there are lots of observations, even minor deviances from the proportional hazard
assumption will be flagged.

With that in mind, it&#39;s best to use a combination of statistical tests and visual tests to determine
the most serious violations. Produce visual plots using ``check_assumptions(..., show_plots=True)``
and looking for non-constant lines. See link [A] below for a full example.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>null_distribution</th>
      <td>chi squared</td>
    </tr>
    <tr>
      <th>degrees_of_freedom</th>
      <td>1</td>
    </tr>
    <tr>
      <th>model</th>
      <td>&lt;lifelines.CoxPHFitter: fitted with 4175 total...</td>
    </tr>
    <tr>
      <th>test_name</th>
      <td>proportional_hazard_test</td>
    </tr>
  </tbody>
</table>
</div><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>test_statistic</th>
      <th>p</th>
      <th>-log2(p)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">facebook_connected</th>
      <th>km</th>
      <td>1.95</td>
      <td>0.16</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>rank</th>
      <td>2.88</td>
      <td>0.09</td>
      <td>3.48</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">facebook_friends</th>
      <th>km</th>
      <td>7.22</td>
      <td>0.01</td>
      <td>7.12</td>
    </tr>
    <tr>
      <th>rank</th>
      <td>5.95</td>
      <td>0.01</td>
      <td>6.08</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">goal</th>
      <th>km</th>
      <td>12.49</td>
      <td>&lt;0.005</td>
      <td>11.26</td>
    </tr>
    <tr>
      <th>rank</th>
      <td>10.95</td>
      <td>&lt;0.005</td>
      <td>10.06</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">has_video</th>
      <th>km</th>
      <td>19.02</td>
      <td>&lt;0.005</td>
      <td>16.24</td>
    </tr>
    <tr>
      <th>rank</th>
      <td>20.93</td>
      <td>&lt;0.005</td>
      <td>17.68</td>
    </tr>
  </tbody>
</table></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Variable &#39;has_video&#39; failed the non-proportional test: p-value is &lt;5e-05.

   Advice: with so few unique values (only 2), you can include `strata=[&#39;has_video&#39;, ...]` in the
call in `.fit`. See documentation in link [E] below.

   Bootstrapping lowess lines. May take a moment...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Bootstrapping lowess lines. May take a moment...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2. Variable &#39;goal&#39; failed the non-proportional test: p-value is 0.0004.

   Advice 1: the functional form of the variable &#39;goal&#39; might be incorrect. That is, there may be
non-linear terms missing. The proportional hazard test used is very sensitive to incorrect
functional forms. See documentation in link [D] below on how to specify a functional form.

   Advice 2: try binning the variable &#39;goal&#39; using pd.cut, and then specify it in `strata=[&#39;goal&#39;,
...]` in the call in `.fit`. See documentation in link [B] below.

   Advice 3: try adding an interaction term with your time variable. See documentation in link [C]
below.


   Bootstrapping lowess lines. May take a moment...
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">cph</span><span class="o">.</span><span class="n">check_assumptions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">show_plots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File ~/.cache/pypoetry/virtualenvs/kickstarter-project-analysis-8mQTRXZa-py3.10/lib/python3.10/site-packages/lifelines/fitters/mixins.py:139,</span> in <span class="ni">ProportionalHazardMixin.check_assumptions</span><span class="nt">(self, training_df, advice, show_plots, p_value_threshold, plot_n_bootstraps, columns)</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>     <span class="n">ix</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>     <span class="n">tt_</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">139</span>     <span class="n">y_lowess</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">tt_</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span>     <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt_</span><span class="p">,</span> <span class="n">y_lowess</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.30</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span> <span class="n">best_xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>

<span class="nn">File ~/.cache/pypoetry/virtualenvs/kickstarter-project-analysis-8mQTRXZa-py3.10/lib/python3.10/site-packages/lifelines/utils/lowess.py:49,</span> in <span class="ni">lowess</span><span class="nt">(x, y, f, iterations)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span>     <span class="n">weights</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">w</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
<span class="ne">---&gt; </span><span class="mi">49</span>     <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">x</span><span class="p">)])</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>     <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="n">x</span><span class="p">)],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">)]])</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span>     <span class="c1"># I think it is safe to assume this.</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span>     <span class="c1"># pylint: disable=unexpected-keyword-arg</span>

<span class="nn">File ~/.cache/pypoetry/virtualenvs/kickstarter-project-analysis-8mQTRXZa-py3.10/lib/python3.10/site-packages/numpy/core/fromnumeric.py:2313,</span> in <span class="ni">sum</span><span class="nt">(a, axis, dtype, out, keepdims, initial, where)</span>
<span class="g g-Whitespace">   </span><span class="mi">2310</span>         <span class="k">return</span> <span class="n">out</span>
<span class="g g-Whitespace">   </span><span class="mi">2311</span>     <span class="k">return</span> <span class="n">res</span>
<span class="ne">-&gt; </span><span class="mi">2313</span> <span class="k">return</span> <span class="n">_wrapreduction</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2314</span>                       <span class="n">initial</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>

<span class="nn">File ~/.cache/pypoetry/virtualenvs/kickstarter-project-analysis-8mQTRXZa-py3.10/lib/python3.10/site-packages/numpy/core/fromnumeric.py:88,</span> in <span class="ni">_wrapreduction</span><span class="nt">(obj, ufunc, method, axis, dtype, out, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span>             <span class="k">return</span> <span class="n">reduction</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">passkwargs</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">88</span> <span class="k">return</span> <span class="n">ufunc</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">passkwargs</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
<img alt="../_images/eaf100a4b6799cff2301511683ef67d6b62de48ec479274ae8d9810b75060d0a.png" src="../_images/eaf100a4b6799cff2301511683ef67d6b62de48ec479274ae8d9810b75060d0a.png" />
<img alt="../_images/639d45d8e4de6f11cdbf43007c5aa90e7eb5b0bc4e6d7ac8cc15e7e5a1b6f6c6.png" src="../_images/639d45d8e4de6f11cdbf43007c5aa90e7eb5b0bc4e6d7ac8cc15e7e5a1b6f6c6.png" />
<img alt="../_images/e981409b1357bab29128255818a088ce34d1c75e9d11d966167c1c67b639e167.png" src="../_images/e981409b1357bab29128255818a088ce34d1c75e9d11d966167c1c67b639e167.png" />
<img alt="../_images/706c74fd2e53465b7470a4d0efead7edf1e790f0b9d9f3ed1b063f5ce9a58594.png" src="../_images/706c74fd2e53465b7470a4d0efead7edf1e790f0b9d9f3ed1b063f5ce9a58594.png" />
</div>
</div>
</section>
<section id="modeles-non-parametrique">
<h2>Mod√®les non-param√©trique<a class="headerlink" href="#modeles-non-parametrique" title="Link to this heading">#</a></h2>
<section id="modele-de-cox">
<h3>Mod√®le de Cox<a class="headerlink" href="#modele-de-cox" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">cph</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>model</th>
      <td>lifelines.CoxPHFitter</td>
    </tr>
    <tr>
      <th>duration col</th>
      <td>'day_succ'</td>
    </tr>
    <tr>
      <th>event col</th>
      <td>'Status'</td>
    </tr>
    <tr>
      <th>baseline estimation</th>
      <td>breslow</td>
    </tr>
    <tr>
      <th>number of observations</th>
      <td>3340</td>
    </tr>
    <tr>
      <th>number of events observed</th>
      <td>1569</td>
    </tr>
    <tr>
      <th>partial log-likelihood</th>
      <td>-11708.02</td>
    </tr>
    <tr>
      <th>time fit was run</th>
      <td>2024-01-15 23:19:26 UTC</td>
    </tr>
  </tbody>
</table>
</div><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th style="min-width: 12px;"></th>
      <th style="min-width: 12px;">coef</th>
      <th style="min-width: 12px;">exp(coef)</th>
      <th style="min-width: 12px;">se(coef)</th>
      <th style="min-width: 12px;">coef lower 95%</th>
      <th style="min-width: 12px;">coef upper 95%</th>
      <th style="min-width: 12px;">exp(coef) lower 95%</th>
      <th style="min-width: 12px;">exp(coef) upper 95%</th>
      <th style="min-width: 12px;">cmp to</th>
      <th style="min-width: 12px;">z</th>
      <th style="min-width: 12px;">p</th>
      <th style="min-width: 12px;">-log2(p)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>has_video</th>
      <td>0.77</td>
      <td>2.15</td>
      <td>0.08</td>
      <td>0.61</td>
      <td>0.92</td>
      <td>1.84</td>
      <td>2.51</td>
      <td>0.00</td>
      <td>9.72</td>
      <td>&lt;0.005</td>
      <td>71.73</td>
    </tr>
    <tr>
      <th>facebook_connected</th>
      <td>-0.04</td>
      <td>0.96</td>
      <td>0.06</td>
      <td>-0.15</td>
      <td>0.07</td>
      <td>0.86</td>
      <td>1.08</td>
      <td>0.00</td>
      <td>-0.64</td>
      <td>0.52</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>goal</th>
      <td>-21.28</td>
      <td>0.00</td>
      <td>1.74</td>
      <td>-24.70</td>
      <td>-17.87</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>-12.21</td>
      <td>&lt;0.005</td>
      <td>111.42</td>
    </tr>
    <tr>
      <th>facebook_friends</th>
      <td>0.15</td>
      <td>1.16</td>
      <td>0.02</td>
      <td>0.11</td>
      <td>0.20</td>
      <td>1.11</td>
      <td>1.22</td>
      <td>0.00</td>
      <td>6.73</td>
      <td>&lt;0.005</td>
      <td>35.79</td>
    </tr>
  </tbody>
</table><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>Concordance</th>
      <td>0.66</td>
    </tr>
    <tr>
      <th>Partial AIC</th>
      <td>23424.05</td>
    </tr>
    <tr>
      <th>log-likelihood ratio test</th>
      <td>409.37 on 4 df</td>
    </tr>
    <tr>
      <th>-log2(p) of ll-ratio test</th>
      <td>287.61</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">cph</span><span class="o">.</span><span class="n">plot_partial_effects_on_outcome</span><span class="p">(</span><span class="n">covariates</span><span class="o">=</span><span class="s2">&quot;has_video&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../_images/86a6d348661b43cb13698bda4378afdd08d5579da1196462c6097ea66644081c.png" src="../_images/86a6d348661b43cb13698bda4378afdd08d5579da1196462c6097ea66644081c.png" />
</div>
</div>
</section>
<section id="cross-validation-cox-aalen-additif">
<h3>Cross-validation (Cox &amp; Aalen additif)<a class="headerlink" href="#cross-validation-cox-aalen-additif" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># create the three models we&#39;d like to compare.</span>
<span class="linenos">2</span><span class="n">aaf_1</span> <span class="o">=</span> <span class="n">AalenAdditiveFitter</span><span class="p">(</span><span class="n">coef_penalizer</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">aaf_2</span> <span class="o">=</span> <span class="n">AalenAdditiveFitter</span><span class="p">(</span><span class="n">coef_penalizer</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">4</span><span class="n">cph</span> <span class="o">=</span> <span class="n">CoxPHFitter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">moyenne_cross_val</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="linenos"> 2</span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
<span class="linenos"> 3</span>        <span class="n">k_fold_cross_validation</span><span class="p">(</span>
<span class="linenos"> 4</span>            <span class="n">model</span><span class="p">,</span>
<span class="linenos"> 5</span>            <span class="n">df</span><span class="p">,</span>
<span class="linenos"> 6</span>            <span class="n">duration_col</span><span class="o">=</span><span class="s2">&quot;day_succ&quot;</span><span class="p">,</span>
<span class="linenos"> 7</span>            <span class="n">event_col</span><span class="o">=</span><span class="s2">&quot;Status&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span>            <span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;concordance_index&quot;</span><span class="p">,</span>
<span class="linenos"> 9</span>        <span class="p">)</span>
<span class="linenos">10</span>    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">models_list</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 2</span>    <span class="s2">&quot;Cox proportionnel&quot;</span><span class="p">:</span> <span class="n">cph</span><span class="p">,</span>
<span class="linenos"> 3</span>    <span class="s2">&quot;Aalen Additive (sans p√©nalit√©)&quot;</span><span class="p">:</span> <span class="n">aaf_1</span><span class="p">,</span>
<span class="linenos"> 4</span>    <span class="s2">&quot;Aalen Additive (p√©nalit√© 10)&quot;</span><span class="p">:</span> <span class="n">aaf_2</span><span class="p">,</span>
<span class="linenos"> 5</span><span class="p">}</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">cox_tab</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 8</span>    <span class="s2">&quot;Mod√®le&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="linenos"> 9</span>    <span class="s2">&quot;Indice de concordance&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="linenos">10</span><span class="p">}</span>  <span class="c1"># todo: rename</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos">13</span>    <span class="n">m</span> <span class="o">=</span> <span class="n">models_list</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>
<span class="linenos">14</span>    <span class="n">moy</span> <span class="o">=</span> <span class="n">moyenne_cross_val</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="linenos">15</span>
<span class="linenos">16</span>    <span class="n">cox_tab</span><span class="p">[</span><span class="s2">&quot;Mod√®le&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="linenos">17</span>    <span class="n">cox_tab</span><span class="p">[</span><span class="s2">&quot;Indice de concordance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">moy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># print(pd.DataFrame(cox_tab).to_markdown(index=False))</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Tableau.</strong> Comparaison des mod√®les de r√©gression non-param√©triques.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Mod√®le</p></th>
<th class="head text-right"><p>Indice de concordance</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Cox proportionnel</p></td>
<td class="text-right"><p>0.656568</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Aalen Additive (sans p√©nalit√©)</p></td>
<td class="text-right"><p>0.586883</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Aalen Additive (p√©nalit√© 10)</p></td>
<td class="text-right"><p>0.588575</p></td>
</tr>
</tbody>
</table>
<p>Interpr√©tation :</p>
<ul class="simple">
<li><p>indice de concordance <strong>&gt; 0.5</strong> =&gt; performance <strong>sup√©rieure</strong> √† du hasard</p></li>
<li><p>indice de concordance <strong>= 0.5</strong> =&gt; performance <strong>√©quivalente</strong> √† du hasard</p></li>
<li><p>indice de concordance <strong>&lt; 0.5</strong> =&gt; performance <strong>inf√©rieure</strong> √† du hasard</p></li>
</ul>
<p>Choix : <strong>mod√®le de Cox proportionnel</strong></p>
</section>
</section>
<section id="predictions">
<h2>Pr√©dictions<a class="headerlink" href="#predictions" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">models_nonparam</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 2</span>    <span class="s2">&quot;Cox proportionnel&quot;</span><span class="p">:</span> <span class="n">cph</span><span class="p">,</span>
<span class="linenos"> 3</span>    <span class="s2">&quot;Aalen additif (sans p√©nalit√©)&quot;</span><span class="p">:</span> <span class="n">aaf_1</span><span class="p">,</span>
<span class="linenos"> 4</span>    <span class="s2">&quot;Aalen additif (avec p√©nalit√©=10)&quot;</span><span class="p">:</span> <span class="n">aaf_2</span><span class="p">,</span>
<span class="linenos"> 5</span><span class="p">}</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">models_param</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 8</span>    <span class="s2">&quot;Weibull AFT&quot;</span><span class="p">:</span> <span class="n">WeibullAFTFitter</span><span class="p">(),</span>
<span class="linenos"> 9</span>    <span class="s2">&quot;Exponentiel morceaux (3)&quot;</span><span class="p">:</span> <span class="n">PiecewiseExponentialRegressionFitter</span><span class="p">(</span>
<span class="linenos">10</span>        <span class="n">breakpoints</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">29</span><span class="p">]</span>
<span class="linenos">11</span>    <span class="p">),</span>
<span class="linenos">12</span>    <span class="s2">&quot;Exponentiel morceaux (5)&quot;</span><span class="p">:</span> <span class="n">PiecewiseExponentialRegressionFitter</span><span class="p">(</span>
<span class="linenos">13</span>        <span class="n">breakpoints</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="linenos">14</span>    <span class="p">),</span>
<span class="linenos">15</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">res_models</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">2</span>    <span class="s2">&quot;Mod√®le&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="linenos">3</span>    <span class="s2">&quot;AIC&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="linenos">4</span>    <span class="s2">&quot;BIC&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="linenos">5</span>    <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="linenos">6</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">models_nonparam</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos"> 2</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">models_nonparam</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
<span class="linenos"> 3</span>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">duration_col</span><span class="o">=</span><span class="s2">&quot;day_succ&quot;</span><span class="p">,</span> <span class="n">event_col</span><span class="o">=</span><span class="s2">&quot;Status&quot;</span><span class="p">)</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_expectation</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="linenos"> 6</span>    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">event_times</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>    <span class="n">res_models</span><span class="p">[</span><span class="s2">&quot;Mod√®le&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="linenos"> 9</span>    <span class="n">res_models</span><span class="p">[</span><span class="s2">&quot;MAE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
<span class="linenos">10</span>    <span class="n">res_models</span><span class="p">[</span><span class="s2">&quot;AIC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="linenos">11</span>    <span class="n">res_models</span><span class="p">[</span><span class="s2">&quot;BIC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">models_param</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos"> 2</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">models_param</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
<span class="linenos"> 3</span>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">duration_col</span><span class="o">=</span><span class="s2">&quot;day_succ&quot;</span><span class="p">,</span> <span class="n">event_col</span><span class="o">=</span><span class="s2">&quot;Status&quot;</span><span class="p">)</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_expectation</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="linenos"> 6</span>    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">event_times</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>    <span class="n">res_models</span><span class="p">[</span><span class="s2">&quot;Mod√®le&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="linenos"> 9</span>    <span class="n">res_models</span><span class="p">[</span><span class="s2">&quot;MAE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
<span class="linenos">10</span>    <span class="n">res_models</span><span class="p">[</span><span class="s2">&quot;AIC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">AIC_</span><span class="p">)</span>
<span class="linenos">11</span>    <span class="n">res_models</span><span class="p">[</span><span class="s2">&quot;BIC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">BIC_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/ab2/.cache/pypoetry/virtualenvs/kickstarter-project-analysis-ue2DmfIx-py3.10/lib/python3.10/site-packages/lifelines/fitters/__init__.py:2371: ApproximationWarning: Approximating using `predict_survival_function`. To increase accuracy, try using or increasing the resolution of the timeline kwarg in `.fit(..., timeline=timeline)`.

  warnings.warn(
/home/ab2/.cache/pypoetry/virtualenvs/kickstarter-project-analysis-ue2DmfIx-py3.10/lib/python3.10/site-packages/lifelines/fitters/__init__.py:2507: ApproximationWarning: Approximating the expected value using trapezoid rule.

  warnings.warn(&quot;&quot;&quot;Approximating the expected value using trapezoid rule.\n&quot;&quot;&quot;, exceptions.ApproximationWarning)
/home/ab2/.cache/pypoetry/virtualenvs/kickstarter-project-analysis-ue2DmfIx-py3.10/lib/python3.10/site-packages/lifelines/fitters/__init__.py:2371: ApproximationWarning: Approximating using `predict_survival_function`. To increase accuracy, try using or increasing the resolution of the timeline kwarg in `.fit(..., timeline=timeline)`.

  warnings.warn(
/home/ab2/.cache/pypoetry/virtualenvs/kickstarter-project-analysis-ue2DmfIx-py3.10/lib/python3.10/site-packages/lifelines/fitters/__init__.py:2507: ApproximationWarning: Approximating the expected value using trapezoid rule.

  warnings.warn(&quot;&quot;&quot;Approximating the expected value using trapezoid rule.\n&quot;&quot;&quot;, exceptions.ApproximationWarning)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># print(pd.DataFrame(res_models).to_markdown(index=False))</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Tableau.</strong> R√©sultats des mod√®les de r√©gression</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Mod√®le</p></th>
<th class="head text-right"><p>AIC</p></th>
<th class="head text-right"><p>BIC</p></th>
<th class="head text-right"><p>MAE</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Cox proportionnel</p></td>
<td class="text-right"><p>nan</p></td>
<td class="text-right"><p>nan</p></td>
<td class="text-right"><p>13.6055</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Aalen additif (sans p√©nalit√©)</p></td>
<td class="text-right"><p>nan</p></td>
<td class="text-right"><p>nan</p></td>
<td class="text-right"><p>13.9461</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Aalen additif (avec p√©nalit√©=10)</p></td>
<td class="text-right"><p>nan</p></td>
<td class="text-right"><p>nan</p></td>
<td class="text-right"><p>14.0145</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Weibull AFT</p></td>
<td class="text-right"><p>19465.7</p></td>
<td class="text-right"><p>19470.3</p></td>
<td class="text-right"><p>3.24738e+77</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Exponentiel morceaux (3)</p></td>
<td class="text-right"><p>19127.7</p></td>
<td class="text-right"><p>19121.1</p></td>
<td class="text-right"><p>13.0742</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Exponentiel morceaux (5)</p></td>
<td class="text-right"><p>19138.1</p></td>
<td class="text-right"><p>19128.1</p></td>
<td class="text-right"><p>13.2367</p></td>
</tr>
</tbody>
</table>
<p>Meilleur mod√®le : <strong>exponentiel par morceaux (3)</strong></p>
<p>Nos 3 meilleurs mod√®les de r√©gression sont :</p>
<ol class="arabic simple">
<li><p>Exponenentiel morceaux (3)</p></li>
<li><p>Exponentiel morceaux (5)</p></li>
<li><p>Cox proportionnel</p></li>
</ol>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="parametric-estimation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Estimation param√©trique univari√©e</p>
      </div>
    </a>
    <a class="right-next"
       href="supervised-regression.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">R√©gression supervis√©e</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#donnees">Donn√©es</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-du-hazard-proportionnel">V√©rification du hazard proportionnel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeles-non-parametrique">Mod√®les non-param√©trique</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modele-de-cox">Mod√®le de Cox</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-cox-aalen-additif">Cross-validation (Cox &amp; Aalen additif)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predictions">Pr√©dictions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ab2nour, jExbrayat
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023, Ab2nour, jExbrayat.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>